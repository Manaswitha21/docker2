pipeline {
    agent any

    stages {
         stage('Docker Hub Login') {
            steps {
                script {
                    // Define your Docker Hub credentials
                    def dockerHubUsername = 'manaswitha2'
                    def dockerHubPassword = 'D@123manu'
                   
                    
                    // Login to Docker Hub
                    sh "docker login -u ${dockerHubUsername} -p ${dockerHubPassword}"
                }
            }
        }

        stage('Deploy Image 1') {
            steps {
                script {
                    // Define the Docker image name and tag
                    def imageName1 = 'manaswitha2/dockerrepo2:one'
                    def imageName2 = 'manaswitha2/dockerrepo2:two'
                    

                    // SSH into your EC2 instance and pull/run the Docker image
                    sshagent(credentials: ['ssh-ec2']) {
                        sh "ssh -o StrictHostKeyChecking=no ec2-user@3.88.128.153 'docker pull ${imageName1}'"
                        sh "docker run -d 3000:3000 ${imageName1}"
                        sh "docker pull ${imageName2}"
                        sh "docker run -d 5000:5000 ${imageName2}"
                    }
                }
            }
        }

    }

}
